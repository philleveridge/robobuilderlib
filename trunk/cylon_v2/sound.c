#include "interupt.h"
#include "sound.h"

/*
const unsigned char sound[] = {
	32,128,48,198,24,99,140,49,198,24,
	99,140,49,198,24,99,140,49,198,56,
	99,140,115,206,24,227,140,57,231,
	24,99,204,49,198,24,115,142,49,231,
	156,115,206,57,231,156,51,198,24,
	99,204,115,206,24,115,142,57,179,
	57,115,166,49,99,142,49,198,25,51,
	102,50,99,198,204,68,204,156,57,179,
	25,51,51,99,102,102,102,204,136,152,
	49,206,24,99,206,57,99,24,115,102,
	114,230,140,198,156,115,156,49,230,
	24,99,206,57,231,156,115,206,57,231,
	156,99,204,57,198,24,115,206,57,103,
	140,113,206,25,227,156,49,198,56,231,
	140,115,206,57,99,156,51,198,24,103,
	140,49,206,24,198,57,103,140,113,206,
	24,227,156,51,198,60,230,140,57,143,
	49,231,156,99,140,49,198,57,231,28,99,
	140,49,198,24,227,28,99,206,24,227,
	156,49,198,24,99,140,49,198,57,231,
	156,115,206,115,140,49,198,24,99,140,
	49,198,24,231,156,115,206,24,231,156,
	51,198,156,99,140,115,142,49,198,24,
	231,156,49,206,57,231,140,113,140,57,
	231,24,99,140,49,198,24,99,140,51,198,
	24,227,25,99,156,115,206,57,199,156,
	115,140,49,198,24,199,140,25,227,24,
	99,140,49,198,152,99,140,49,198,24,231,
	156,51,206,49,198,24,99,140,49,198,57,
	103,156,99,140,57,199,24,99,206,24,206,
	24,231,28,99,140,113,206,25,99,156,115,
	206,25,231,156,51,142,49,198,24,199,
	140,49,67,24,99,204,24,195,152,51,142,
	49,198,56,198,156,115,140,49,198,24,
	198,136,24,195,24,99,12
	
};
*/
/*  const unsigned char sound[] = {
	0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,8,0,0,2,32,0,
	0,0,0,0,128,0,0,0,0,2,0,
	0,0,0,0,1,0,16,80,2,160,0,
	0,30,0,188,0,126,0,124,1,240,2,
	237,1,222,7,248,15,248,60,240,115,192,
	207,129,159,7,127,14,252,56,240,241,226,
	199,133,143,23,63,110,252,188,240,113,227,
	199,248,184,241,227,194,207,137,31,19,126,
	78,252,24,240,115,224,198,128,159,3,55,
	6,220,24,184,49,224,198,204,141,17,51,
	102,78,216,152,49,99,66,206,140,25,51,
	118,100,204,152,17,35,103,204,136,145,35,
	2,70,140,24,17,50,98,196,136,128,1,
	35,70,12,24,24,49,96,192,128,24,1,
	3,6,64,12,24,48,0,2,128,12,0,
	1,0,6,128,8,0,1,0,12,128,0,
	1,48
};
*/

void play_tone(int delay, int duration) {
  // delay is half-period in microseconds
  // duration is in 10ms increments
  
  // example: 440Hz --> delay=1136
  
  
  // duration = 2*delay * cycles (all in same units)
  // cycles = 10000 * duration / delay / 2
  // cycles = 100 * duration / (delay/50)
  int tmp = 100 * duration;
  int delaysm = delay / 50;
  int cycles = tmp / delaysm;
    
  while(cycles > 0) {
	PORTA ^= 0X10; 
    delay_us(delay);
	PORTA ^= 0X10; 
    delay_us(delay);
    cycles--;
  }
}

unsigned char s_mask;
char *s_bytes, *s_bytes_;
unsigned char c_byte;

extern int wlc;

/*
void play_sound(unsigned char sound_id, int ptime) {

unsigned char sound_bytes_0[] = { 0xAA, 0xAA, 0xAA};
unsigned char sound_bytes_1[] = { 0xCC, 0xCC, 0xCC};

		
	// play sound from array
	int sz;
	char *sb;
	
	switch(sound_id) {
	case 0:
		sz = sizeof(sound_bytes_0);
		sb = &sound_bytes_0[0];
		break;
	case 1:
		sz = sizeof(sound_bytes_1);
		sb = &sound_bytes_1[0];
		break;
	}
	
	s_mask=1
		
	while (ptime-- > 0)
	{
		if (s_mask==0)
		{
			s_mask=1;
			s_bytes++;
			if ((s_bytes-sb) >= sz)
				s_bytes=sb;
		}
		if ((s_mask & *s_bytes) != 0)
		{
			PORTA |= 0x80;  		//Bit 7 On
			PORTA &= 0xBF;  		//Bit 6 Off
		}
		else
		{
			PORTA &= 0x7F;  		//Bit 7 Off
			PORTA |= 0x40;  		//Bit 6 On
		}

		s_mask <<= 1;	
		
		delay(1);
	}
}

*/
